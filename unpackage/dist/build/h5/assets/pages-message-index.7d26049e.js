import{m as e,o as a,c as t,w as l,b as s,e as o,t as r,f as i,i as u,g as n,k as c,n as d,q as f,v as m,u as p,x as v,F as g,S as _,y as h}from"./index-414aba9e.js";import{_ as y}from"./uni-dateformat.6711ea4d.js";import{r as k}from"./uni-app.es.62e4e15a.js";import{_ as b,a as j}from"./uni-list.99731169.js";import{e as w}from"./empty.a8491228.js";import{_ as x}from"./uni-card.4a40679a.js";import{_ as C}from"./_plugin-vue_export-helper.1b428a4d.js";import{m as M,a as S}from"./api.9a16dbfa.js";import"./uni-icons.8c24d49d.js";import"./uni-fetch.cbece254.js";const R=C({__name:"taskItem",props:{item:{type:Object}},setup:c=>(d,f)=>{const m=u,p=n,v=k(e("uni-dateformat"),y),g=k(e("uni-card"),x);return a(),t(p,{class:"item"},{default:l((()=>[s(g,{title:""},{title:l((()=>[s(p,{class:"top"},{default:l((()=>[s(m,null,{default:l((()=>[o(r(c.item.title),1)])),_:1}),0==c.item.isRead?(a(),t(m,{key:0,class:"iconfont icon-dot"})):i("",!0)])),_:1})])),default:l((()=>[s(p,{class:"uni-body"},{default:l((()=>[o(r(c.item.content),1)])),_:1}),s(p,{class:"bot"},{default:l((()=>[s(v,{class:"time",date:c.item.created,format:"yyyy.MM.dd hh:mm"},null,8,["date"]),s(p,{class:"btn"},{default:l((()=>[o("查看详情")])),_:1})])),_:1})])),_:1})])),_:1})}},[["__scopeId","data-v-2d7d6900"]]),I=C({__name:"index",setup(r){const x=c([]),C=c([]),I=c(!1),T=c(!1),z=c(!1),N=c(!1),$=c({contentType:200,page:0,pageSize:5}),q=c({contentType:201,page:0,pageSize:5}),F=c(0),O=async()=>{try{$.value.page+=1;let e=await M($.value);1===$.value.page&&(x.value=[]),x.value=[...x.value,...e.data.items||[]],console.log($.value.page),z.value=$.value.page==e.data.pages}catch(e){}};O();const A=async()=>{q.value.page+=1;let e=await M(q.value);1===q.value.page&&(C.value=[]),C.value=[...C.value,...e.data.items||[]],console.log(q.value.page),N.value=q.value.page==e.data.pages};A();const B=async()=>{I.value=!0,$.value.page=0,await O(),I.value=!1},D=async()=>{T.value=!0,q.value.page=0,await A(),T.value=!1},E=e=>{z.value||O()},G=e=>{N.value||A()},H=async()=>{await S(200),B()},J=async()=>{await S(201),D()};return(r,c)=>{const M=n,S=u,N=k(e("uni-dateformat"),y),$=k(e("uni-list-item"),b),q=k(e("uni-list"),j),O=_;return a(),t(M,{class:"msg-page"},{default:l((()=>[s(M,{class:"inv-h-w"},{default:l((()=>[s(M,{class:d(["inv-h",0==F.value?"inv-h-se":""]),onClick:c[0]||(c[0]=e=>F.value=0)},{default:l((()=>[o("公告")])),_:1},8,["class"]),s(M,{class:d(["inv-h",1==F.value?"inv-h-se":""]),onClick:c[1]||(c[1]=e=>F.value=1)},{default:l((()=>[o("任务通知")])),_:1},8,["class"])])),_:1}),0!==x.value.length?(a(),t(O,{key:0,"refresher-triggered":I.value,onRefresherrefresh:B,"refresher-enabled":"",onScrolltolower:E,"scroll-y":"true",class:"scroll-view"},{default:l((()=>[f(s(M,{class:"Notice-top"},{default:l((()=>[s(M,{class:"top"},{default:l((()=>[s(S,{style:{"margin-right":"20rpx"},class:"iconfont icon-broom"}),s(S,{onClick:H},{default:l((()=>[o("全部已读")])),_:1})])),_:1}),s(M,{class:"nav"},{default:l((()=>[s(q,{border:!1},{default:l((()=>[(a(!0),p(g,null,v(x.value,((e,o)=>(a(),t($,{onClick:a=>(e=>{console.log(11111),h({url:`/pages/message/Notice/index?content=${e.content}&time=${e.created}`})})(e),clickable:"",key:o,ellipsis:"1",title:e.title},{header:l((()=>[0==e.isRead?(a(),t(M,{key:0,class:"slot-box"},{default:l((()=>[s(S,{class:"iconfont icon-dot"})])),_:1})):i("",!0)])),footer:l((()=>[s(N,{class:"rightTitle",date:e.created,format:"MM-dd hh:mm"},null,8,["date"])])),_:2},1032,["onClick","title"])))),128))])),_:1})])),_:1})])),_:1},512),[[m,0==F.value]])])),_:1},8,["refresher-triggered"])):i("",!0),f(s(O,{"refresher-triggered":T.value,onRefresherrefresh:D,"refresher-enabled":"",onScrolltolower:G,"scroll-y":"true",class:"scroll-view"},{default:l((()=>[s(M,{class:"task"},{default:l((()=>[s(M,{class:"top"},{default:l((()=>[s(S,{style:{"margin-right":"20rpx"},class:"iconfont icon-broom"}),s(S,{onClick:J},{default:l((()=>[o("全部已读")])),_:1})])),_:1}),(a(!0),p(g,null,v(C.value,((e,l)=>(a(),t(R,{key:l,item:e},null,8,["item"])))),128)),z.value?(a(),t(M,{key:0,class:"noMore"},{default:l((()=>[o("没有更多了")])),_:1})):i("",!0)])),_:1})])),_:1},8,["refresher-triggered"]),[[m,1==F.value]]),0==x.value.length?(a(),t(w,{key:1})):i("",!0)])),_:1})}}},[["__scopeId","data-v-af86dbba"]]);export{I as default};
