import{k as e,M as a,o as l,c as t,w as o,g as s,b as u,A as i,e as r,u as n,x as p,F as d,Q as c,N as f,m,B as _,p as v,R as x,i as g,T as h}from"./index-414aba9e.js";import{_ as y}from"./uni-dateformat.6711ea4d.js";import{o as k,r as b}from"./uni-app.es.62e4e15a.js";import{_ as j}from"./uni-datetime-picker.915ccd85.js";import{_ as w,a as V}from"./uni-list.99731169.js";import{_ as T}from"./uni-file-picker.b3833dec.js";import{_ as A}from"./uni-popup.df6f0ab0.js";import{r as C}from"./taskApi.c3c7a53c.js";import{_ as I}from"./_plugin-vue_export-helper.1b428a4d.js";import"./uni-icons.8c24d49d.js";import"./uni-fetch.cbece254.js";const M=I({__name:"index",setup(I){const M=e(""),U=e(""),z=e(""),q=e(""),B=e("popup"),E=["发动机启动困难","不着车，漏油","照明失灵","排烟异常、温度异常","其他问题"],F=e(""),L=a((()=>M.value));k((e=>{U.value=e.id}));const N=async()=>{let{address:e}=await c({});console.log(e),F.value=e},P=()=>{B.value.open()},Q=[],R=e=>{Q.push(e.detail.value[0]),console.log("tempException",Q)},D=()=>{B.value.close(),q.value=Q.join("|")},G=e([]),H=a((()=>G.value.map((e=>({url:e.url}))))),J=async()=>{try{const e={transportTaskId:U.value,exceptionTime:L.value,exceptionPlace:F.value,exceptionType:q.value,exceptionImagesList:H.value};await C(e);f({url:"/pages/task/index"})}catch(e){console.log(e)}};return(e,a)=>{const c=b(m("uni-dateformat"),y),f=s,k=b(m("uni-datetime-picker"),j),C=b(m("uni-list-item"),w),I=_,U=b(m("uni-list"),V),Q=b(m("uni-file-picker"),T),H=v,K=x,O=g,S=h,W=b(m("uni-popup"),A);return l(),t(f,{class:"except-page"},{default:o((()=>[u(f,{class:"top"},{default:o((()=>[u(U,{border:!1},{default:o((()=>[u(C,{showArrow:"",title:"异常时间",rightText:"请选择"},{footer:o((()=>[u(k,{modelValue:M.value,"onUpdate:modelValue":a[0]||(a[0]=e=>M.value=e)},{default:o((()=>[u(f,{class:"picker-value"},{default:o((()=>[M.value?(l(),t(c,{key:0,date:i(L),format:"yyyy.MM.dd hh:mm"},null,8,["date"])):(l(),t(f,{key:1,class:""},{default:o((()=>[r("请选择")])),_:1}))])),_:1})])),_:1},8,["modelValue"])])),_:1}),u(C,{clickable:"",onClick:N,showArrow:"",title:"上报位置",rightText:F.value?F.value:"请选择"},null,8,["rightText"]),u(C,{clickable:"",onClick:P,showArrow:"",title:"异常类型","right-text":q.value||"请选择"},null,8,["right-text"]),u(C,{class:"child"},{header:o((()=>[u(f,{style:{"font-size":"14px"}},{default:o((()=>[r("异常描述")])),_:1})])),body:o((()=>[u(f,null,{default:o((()=>[u(I,{maxlength:"50",modelValue:z.value,"onUpdate:modelValue":a[1]||(a[1]=e=>z.value=e),placeholder:"请输入异常描述"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),u(f,{class:"bot"},{default:o((()=>[u(f,{style:{"margin-bottom":"30rpx","font-size":"14px"}},{default:o((()=>[r("上传图片 (最多6张)")])),_:1}),u(Q,{modelValue:G.value,"onUpdate:modelValue":a[2]||(a[2]=e=>G.value=e),"file-extname":"jpg,webp,gif,png",limit:"3"},null,8,["modelValue"])])),_:1}),u(f,{class:"botbar"},{default:o((()=>[u(H,{onClick:J},{default:o((()=>[r("提交")])),_:1})])),_:1}),u(W,{class:"pop",ref_key:"popup",ref:B,type:"bottom"},{default:o((()=>[u(f,{style:{"background-color":"#fff","min-height":"500rpx","border-top-left-radius":"50rpx","border-top-right-radius":"50rpx"}},{default:o((()=>[u(f,{style:{display:"flex","justify-content":"space-between","align-items":"center"}},{default:o((()=>[u(f,{class:"title"},{default:o((()=>[r("选择类型")])),_:1}),u(f,{style:{color:"transparent","padding-right":"44rpx"},class:"iconfont icon-clear"})])),_:1}),u(U,null,{default:o((()=>[(l(),n(d,null,p(E,((e,a)=>u(C,{key:a,title:e},{footer:o((()=>[u(S,{onChange:R},{default:o((()=>[u(K,{round:"",value:e},null,8,["value"]),u(O)])),_:2},1024)])),_:2},1032,["title"]))),64))])),_:1}),u(C,null,{body:o((()=>[u(H,{onClick:D,class:"button",type:"default"},{default:o((()=>[r("确定")])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})}}},[["__scopeId","data-v-a07ce5a4"]]);export{M as default};
